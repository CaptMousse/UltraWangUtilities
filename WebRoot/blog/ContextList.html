<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ContextList</title>
    <link rel="stylesheet" type="text/css" href="/resource/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/resource/css/baseCss.css">
    <style>
        .modal-data {
            max-width: 600px;
            width: 80%;
            margin: 200px auto;
            background-color: #fff;
            border: 2px solid #000;
            border-radius: 5px;
            padding: 15px;
        }

        .media-object {
            width: 100px;
            height: 100px;
            object-fit: cover;
        }
        
        .item {
            text-align: center;
            /* position: relative; */
        }
        .imgSlide{
            width: 100%;
            max-height: 540px;
            min-height: 540px;
            /* display: inline-block;
            vertical-align: middle; */
            object-fit: cover;
        }
        .pointerCursor {
            cursor: pointer;
        }
    </style>
    <script src="/resource/js/jquery-3.6.0.min.js"></script>
    <script src="/resource/js/bootstrap.min.js"></script>
    <script src="/resource/js/baseFunction.js"></script>
    <script>
        function init() {

            var contextRecommend = ajax("get", "blog/context/getContextRecommend", false);
            for (let i = 0; i < contextRecommend.length; i++) {
                let context = contextRecommend[i];
                let active = "";
                if (i == 0) {
                    active = "active";
                }
                let innerHTML = '<div class="item ' + active + '">'
                    + '<img class="imgSlide" src="' + getAddress() + context.cover_img_location + '" loading="lazy">'
                    + '<div class="container">'
                    +    '<div class="carousel-caption" onclick="contextShow(\'' + context.uuid + '\')">'
                    +        '<h1 class="pointerCursor">' + context.title + '</h1>'
                    +        '<p class="pointerCursor">' + context.brief + '</p>'
                    // +        '<p><a class="btn btn-lg btn-primary" href="javascript:contextShow(\'' + context.uuid + '\')" role="button">查看详情</a></p>'
                    +    '</div></div></div>';
                document.getElementById('contextRecommend').innerHTML += innerHTML;

            }

            var contextList = ajax("get", "blog/context/contextList", false);
            for (let i = 0; i < contextList.length; i++) {
                let context = contextList[i];
                document.getElementById('contextList').innerHTML += '<div class="media" onclick="contextShow(\'' + context.uuid + '\')"><div class="media-left"><a><img class="media-object" src="' + getAddress() + context.cover_img_location + '" alt="' + context.title + '"></a></div><div class="media-body"><h4 class="media-heading">' + context.title + '</h4>' + context.brief + '<br>更新时间: ' + context.update_time + '</div></div>';
                document.getElementById('contextList').innerHTML += '<br>';
            }

        }

        function contextShow(uuid) {
            window.location.href = "ContextShow.html?uuid=" + uuid;
            // var resultContext = ajax("get", "blog/context/contextRead?contextId=" + uuid, false);
            // contextModal(resultContext);
        }

        function contextModal(resultContext) {
            // showModal();
            // document.getElementById('modalLegend').innerText = resultContext.title;
            // document.getElementById('modalDiv').innerHTML = resultContext.context;
            // window.location.href = "ContextShow.html?id=" + resultContext.uuid;
        }
    </script>
</head>

<body onload="init()">
    <div id="divHeader">
        <script>
            $('#divHeader').load('../resource/header.html');
            // var activeHeader = "idiompedia";
        </script>
    </div>

    <!-- 列表 -->
    <div id="divBody">

        <div id="myCarousel" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ol class="carousel-indicators">
                <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                <li data-target="#myCarousel" data-slide-to="1" class=""></li>
                <li data-target="#myCarousel" data-slide-to="2" class=""></li>
            </ol>
            <div id="contextRecommend" class="contextSlide carousel-inner" role="listbox">
                <!-- <div class="item active">
                    <img class="imgSlide" src="http://127.0.0.1:8125/blog/context/downloadImage?image=e6282c1c9b9d47d49fbfba35f167236a.jpg">
                    <div class="container">
                        <div class="carousel-caption">
                            <h1>Example headline.</h1>
                            <p>Note: If you're viewing this page via a <code>file://</code> URL, the "next" and
                                "previous" Glyphicon buttons on the left and right might not load/display properly due
                                to web browser security rules.</p>
                            <p><a class="btn btn-lg btn-primary" href="#" role="button">Sign up today</a></p>
                        </div>
                    </div>
                </div>
                <div class="item">
                    <img class="imgSlide" src="http://127.0.0.1:8125/blog/context/downloadImage?image=e162f382ee5b4985af2817cc9b78b707.jpg">
                    <div class="container">
                        <div class="carousel-caption">
                            <h1>Another example headline.</h1>
                            <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta
                                gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                            <p><a class="btn btn-lg btn-primary" href="#" role="button">Learn more</a></p>
                        </div>
                    </div>
                </div>
                <div class="item">
                    <img class="imgSlide" src="http://127.0.0.1:8125/blog/context/downloadImage?image=8cded001c93d4c488cdf9c6124585d61.jpg">
                    <div class="container">
                        <div class="carousel-caption">
                            <h1>One more for good measure.</h1>
                            <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta
                                gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                            <p><a class="btn btn-lg btn-primary" href="#" role="button">Browse gallery</a></p>
                        </div>
                    </div>
                </div> -->
            </div>
            <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">文章列表</h3>
            </div>
            <div id="contextList" class="panel-body">
                <!-- <div class="media"><div class="media-left"><a href="#"><img class="media-object" src="" alt="..."></a></div><div class="media-body"><h4 class="media-heading">Media heading</h4>...</div></div> -->
                <!-- <div class="media">
                    <div class="media-left">
                        <a href="#">
                            <img class="media-object" src="" alt="...">
                        </a>
                    </div>
                    <div class="media-body">
                        <h4 class="media-heading">Media heading</h4>
                        ...
                    </div>
                </div> -->
            </div>
        </div>
    </div>

    <div id="divFooter">
        <script>
            $('#divFooter').load('../resource/footer.html');
        </script>
    </div>

    <div id="modal-background" style="visibility: hidden;">
        <div class="modal-data">
            <fieldset class="fieldset">
                <legend id="modalLegend"></legend>
                <div id="modalDiv">

                </div>
            </fieldset>
            <p style="text-align: center"><a onclick="showModal()">[关闭]</a></p>
        </div>
    </div>
</body>

</html>